// @description Audio, vidéo et Caneva

// @note Classe `video` prévue pour les sources vidéos extérieures au site
// @note Classe `map` pour les cartes

audio
video
canvas
  width: 100%

video
.video
  background-color: #000 // @bugfix @affected Google Maps @note Pas de background prédéfinit sur élément `canvas` afin d'éviter les conflits.
  box-shadow: _shadow15

audio
video
  outline: none

//audio
//  height: 3em // @bugfix @affected All browsers @note Nécessaire au positionnement

audio:not([controls])
  display: none // @affected All browsers @note Affichage de l'audio sans contrôle

// @bugfix Redimentionnement de l'élément video à la lecture @note La solution adoptée est de mettre un poster de même dimention que le flux vidéo
//video
//  object-fit cover // @affected Firefox @note Influence sur l'image des posters

.audio
  display: none

_rangeBlockThumb2 =
  pointer-events: auto
  width: .3em
  aspect-ratio: 1
  background-color: transparent //_color2
  //border: .2em solid _rangeColor5
  border-radius: 50%
  //box-shadow: _shadow6

.audio-player
  display: flex
  //flex-direction: row
  justify-content: space-between
  align-items: center
  gap: .5em
  width: 100%
  height: 3em
  background-color: _colorG + 7%
  border-radius: 2em
  box-shadow: box-shadow: _shadow17
  & > *
    align-self: center
  & button
    all: unset
    flex-shrink: 0
    display: grid
    height: 3em
    outline: none
    cursor: pointer
    & svg
      width: 1.2em
      height: 1.2em
      margin: auto
  & .audio-progress-bar
    --stop: 0%
  & .audio-volume-bar
    --stop: 50%
  & .audio-progress-bar
  & .audio-volume-bar
    --colorSlide: _color2
    all: unset
    height: .3em
    color: _color2
    background-color: _colorG + 14%
    background-image: linear-gradient(90deg, var(--colorSlide) 0, var(--colorSlide) var(--stop), transparent var(--stop))
  & .audio-progress-bar:focus
  & .audio-progress-bar:hover
  & .audio-progress-bar:active
  & .audio-volume-bar:focus
  & .audio-volume-bar:hover
  & .audio-volume-bar:active
    --colorSlide: _color5
    /*
    &:focus::-webkit-slider-thumb
    &:hover::-webkit-slider-thumb
    &:active::-webkit-slider-thumb
      background-color: _color5
    &:focus::-moz-range-thumb
    &:hover::-moz-range-thumb
    &:active::-moz-range-thumb
      background-color: _color5
    */
  & ::-webkit-slider-thumb
    //all: unset
    -webkit-appearance: none
    {_rangeBlockThumb2}
  & ::-moz-range-thumb
    box-sizing: border-box // @affected Firefox @note Définition obligatoire de cette règle malgré sa déclaration en globale.
    border: none
    {_rangeBlockThumb2}

  & .audio-play-pause
    width: 3em
    background-color: _colorG + 14%
    border-radius: 50%
    &.active
      position: relative
      z-index: 1
      background-color: _colorG + 14%
      &::before
        content ''
        position: absolute
        inset: 0
        z-index: -1
        border: .35em solid _colorG + 14%
        border-block-color: _color2
        border-radius: 50%
        //background: repeating-conic-gradient((_colorG + 7%) 0 90deg, (_colorG + 14%) 0 180deg)
        //background: repeating-conic-gradient(#ff826c 0 90deg, _color2 0 180deg) // somme des deux angles doit être un multiple de 360°
        animation anim-play var(--frame, 20s) linear infinite
    &:focus-visible
    //&:hover
    //&:active
      background-color: _color2
  & .audio-play-pause
  & .audio-volume
    & > :last-child
      display: none
    &.active
      & > :first-child
        display: none
      & > :last-child
        display: initial
  & .audio-volume
  & .audio-menu
    width: 2em
    &:focus-visible
    //&:hover
    //&:active
      color: _color2
  & .audio-menu
    margin-right: 1em
  & .audio-progress-bar
    flex-grow: 1
  & .audio-play-pause.active ~ .audio-volume.active
    animation: anim-mute 1s infinite // Si lecture et fonction mute activée, alors le bouton mute clignote ; pour rappeler lors de la reprise d'une lecture que la fonction mute est active.
  & .audio-volume-bar
    width: 0
    transition: width .5s
  & .audio-volume-bar:focus
  & .audio-volume-bar:hover
  & .audio-volume-bar:active
  & .audio-volume:focus + .audio-volume-bar
  & .audio-volume:hover + .audio-volume-bar
  & .audio-volume:active + .audio-volume-bar
    width: 20%
  & .audio-play-pause
    order: 1
  & .audio-time
    order: 2
  & .audio-progress-bar
    order: 3
  & .audio-volume
    order: 5
  & .audio-volume-bar
    order: 4
  & .audio-menu
    order: 6
    


@keyframes anim-play
  from
    transform rotate(0deg)
  to
    transform rotate(359deg)

@keyframes anim-mute
  50%
    color: _colorG + 14%

.video-youtube
  position: relative // [1] Évite un léger resize entre le thumbnail et le chargement de la vidéo.
  aspect-ratio: 16/9
  user-select: none
  background-color: #000
  & iframe
  & > div
    position: absolute // [1]
    inset: 0
  & .video-youtube-error
    text-align: center
  & .thumbnail-youtube
    display: grid
    place-content: center
    background-size: cover
    background-position: 50% 50% // @note Pour positionner correctement les images plus petites que l'élément.
    & button
      all: unset
      position: relative
      width: 5em
      //aspect-ratio: 1/1
      //max-width: 50%
      outline: none
      & svg
        fill: rgba(255, 255, 255, .7)
      &:focus svg
      &:hover svg
        fill: _color5
  & .video-youtube-title
    position: absolute
    top: 0
    left: 0
    right: 0
    padding: .5em 1em
    overflow: hidden
    white-space: nowrap
    text-align: right
    text-overflow: ellipsis
    text-shadow: 0 0 .2em rgba(0, 0, 0, .8)
  //@media (hover: hover) and (pointer: fine)
