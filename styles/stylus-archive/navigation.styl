_navigationSizeRow = 2.5em
_navigationSizeRowXS = 3em
_navigationSizeTranslate = 110vw
_navigationFix = 177px
_navigationColor1 = _colorG - 34%
_navigationColor2 = _colorT2
_navigationColor3 = _color2
_navigationColor4 = _color5
_navigationColor5 = _color2

.nav
  position: relative
  z-index: 2000 // @note Permet de passer au-dessus du pseudo élément de body (ce dernier faisant un effet d'ombrage sur le contenu en version mobile) et aussi de certains éléments définis par des sources externes (comme les Maps Leaflet).
  display: grid
  user-select: none
  @media (max-width: _sizeNav)
    grid-template-rows: _navigationSizeRowXS
    grid-template-columns: _navigationSizeRowXS minmax(0, 1fr) _navigationSizeRowXS // @note Laisse une place au logo du site.
    grid-template-areas: 'logo breadcrumb cmd'
  @media (min-width: _sizeNav)
    grid-template-rows: repeat(2, _navigationSizeRow)
    grid-template-columns: (_navigationSizeRow * 2) minmax(0, 1fr) // @note Laisse une place au logo du site.
    grid-template-areas: 'logo subnav' 'logo breadcrumb'
  background-color: _navigationColor1
  & .avatar
    display: inline-block
    vertical-align: -.5em
    width: 1.7em
    aspect-ratio: 1
    margin-inline-end: .5em
    background-color: #111
    background-image: var(--img)
    background-size: cover
    border-radius: 50%

.logo-nav
  grid-area: logo
  display: block
  box-shadow: _shadow2
  background-color: _color2
  &::after
    content: ''
    display: block
    width: 100%
    height: 100%
    background-image: url(../medias/images/logo/logo.svg) //url(../medias/images/logo/195v.svg)
    background-repeat: no-repeat
    background-position: 50% 50%
    background-size: auto 70%
    filter: brightness(1.25) contrast(1.25)
    //box-shadow: _shadow3

a.logo-nav
  &:focus-within
  &:hover
    background-color: _color5
    &::after
      animation: anim-logo .5s ease-in-out

@keyframes anim-logo
  30%
    transform: rotate(-30deg)

.sub-nav
  grid-area: subnav
  box-shadow: _shadow2
  display: flex
  width: 100%
  margin: 0
  padding: 0
  & li
    list-style: none
    & > *
      display: block
      padding: 0 1em
      line-height: unit(_navigationSizeRow, '') // @todo Ou _navigationSizeRow tout simplement...
      box-shadow: _shadow3
  & .current
    background-color: _navigationColor3
  & a
    overflow: hidden
    white-space: nowrap
    text-overflow: ellipsis
    color: _navigationColor2
    text-decoration: none
    &:focus
    &:hover
    &:active
      color: #fff
      background-color: _navigationColor3
    &:focus svg
    &:hover svg
    &:active svg
      animation: anim-jump .5s ease-in-out
  @media (max-width: _sizeNav)
    position: absolute
    z-index: 800
    top: _navigationSizeRowXS
    left: 0
    width: 100vw
    flex-wrap: wrap
    transform: translateX(- _navigationSizeTranslate) // @note L'utilisation des pourcentages provoque un effet de bord avec overflow:clip sur le body ; à éviter. Valeur au-delà de 100vw afin de cacher les ombres des boîtes.
    & li
      flex: 1
      flex-basis: 50%
      background-color: _navigationColor1
      transform: rotate(90deg)
      transition: transform .4s ease-in-out
      & > *
        line-height: unit(_navigationSizeRowXS, '')
    &.active li
      transform: translateX(_navigationSizeTranslate) rotate(0deg)
  @media (min-width _sizeNav)
    & .current
      position: relative
      z-index: 10 // @note La valeur doit être suffisante pour passer au-dessus des items de .breadcrumb
      &::after
        content: ''
        position: absolute
        top: 100%
        left: calc(50% - 1em)
        width: 2em
        height: 1em
        background-color: _navigationColor3
        clip-path: polygon(0 0, 100% 0, 50% 100%)
    & > :last-child
      margin-inline-start: auto
  @media (min-width: _sizeXS) and (max-width: _sizeNav)
    & li
      flex-basis: 33%
  @media (min-width: _sizeS) and (max-width: _sizeNav)
    & li
      flex-basis: 25%

@media (max-width: _sizeNav)

  :where(html, body).active
    overflow: clip

  body.active
    &::before
      content: ''
      position: absolute
      z-index: 1
      inset: 0
      width: 100vw
      height: 100vh
      background-color: rgba(0, 0, 0, .7)
    & :where(main, footer, aside)
      user-select: none
      pointer-events: none
      filter: blur(2px) grayscale(1)

  _x = 12

  for _i in 1.._x
    _tt = (_i / 3) / _x
    .sub-nav li:nth-child({_i})
      transition-delay: '%ss' % round(_tt, 2)

@media (min-width: _sizeNav)
  @keyframes anim-jump
    30%
      transform: translateY(-.3em)

.cmd-nav
  all: unset
  grid-area: cmd
  @media (max-width: _sizeNav)
    padding: .5em
    cursor: pointer
    background-color: _navigationColor1
    & svg
      width: 100%
      height: 100%
      transition: .2s background-color
    & rect
      transform-origin: center
      fill: _colorT
      transition: .2s all ease-in-out
      //transition-property: x, y, width, height, transform
    &:not(:focus):not(:hover):not(.active)
      & svg
        border-radius: 50%
        background-color: _color2
      & rect
        x: 450px
        width: 100px
        height: 100px
    &:focus
    &:hover
    &.active
      background-color: _color2
    &.active svg
      & :nth-child(1)
        transform: translate(- _navigationFix, _navigationFix) rotate(45deg)
      & :nth-child(2)
        transform: rotate(-45deg)
      & :nth-child(3)
        transform: translate(- _navigationFix, - _navigationFix) rotate(-45deg)
  @media (min-width _sizeNav)
    display: none

.no-js .cmd-nav
  display: none
